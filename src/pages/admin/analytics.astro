---
import AdminLayout from "@layouts/AdminLayout.astro";

const metrics = [
    { label: "Page Views", value: "284,592", change: "+15.3%", period: "vs last month" },
    { label: "Unique Visitors", value: "42,847", change: "+8.7%", period: "vs last month" },
    { label: "Avg. Session", value: "4m 32s", change: "+12.1%", period: "vs last month" },
    { label: "Bounce Rate", value: "32.4%", change: "-5.2%", period: "vs last month" },
];

const topPages = [
    { path: "/", views: 45892, percentage: 35 },
    { path: "/products", views: 28453, percentage: 22 },
    { path: "/about", views: 18234, percentage: 14 },
    { path: "/contact", views: 12847, percentage: 10 },
    { path: "/blog", views: 9823, percentage: 8 },
];

const trafficSources = [
    { source: "Organic Search", visitors: 18234, percentage: 42, color: "from-violet-500 to-fuchsia-500" },
    { source: "Direct", visitors: 12453, percentage: 29, color: "from-emerald-400 to-cyan-400" },
    { source: "Social Media", visitors: 7823, percentage: 18, color: "from-orange-400 to-rose-400" },
    { source: "Referral", visitors: 4337, percentage: 11, color: "from-blue-400 to-indigo-400" },
];
---

<AdminLayout title="Analytics" currentPage="analytics">
    <!-- Metrics Grid -->
    <div class="grid grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6 mb-6">
        {metrics.map((metric, i) => (
            <div class="rounded-2xl bg-white/[0.03] border border-white/[0.08] p-4 sm:p-6">
                <p class="text-sm text-white/50">{metric.label}</p>
                <p class="text-2xl sm:text-3xl font-bold text-white mt-1">{metric.value}</p>
                <div class="flex items-center gap-2 mt-2">
                    <span class:list={[
                        "text-sm font-medium",
                        metric.change.startsWith("+") ? "text-emerald-400" : "text-rose-400"
                    ]}>
                        {metric.change}
                    </span>
                    <span class="text-xs text-white/30">{metric.period}</span>
                </div>
            </div>
        ))}
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
        <!-- Visitors Chart -->
        <div class="rounded-2xl bg-white/[0.03] border border-white/[0.08] p-5 sm:p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="font-semibold text-white">Visitors Overview</h3>
                <select class="text-sm bg-white/[0.05] border border-white/[0.1] rounded-lg px-3 py-1.5 text-white/70 focus:outline-none">
                    <option>Last 7 days</option>
                    <option>Last 30 days</option>
                    <option>Last 90 days</option>
                </select>
            </div>
            <!-- Chart -->
            <div class="h-48 flex items-end justify-around gap-2">
                {[35, 55, 40, 70, 45, 85, 60].map((h, i) => (
                    <div class="flex-1 flex flex-col items-center gap-2">
                        <div 
                            class="w-full rounded-t-lg bg-gradient-to-t from-cyan-500 to-blue-500 opacity-80 hover:opacity-100 transition-opacity"
                            style={`height: ${h}%`}
                        ></div>
                        <span class="text-[10px] text-white/30">{['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'][i]}</span>
                    </div>
                ))}
            </div>
        </div>

        <!-- Traffic Sources -->
        <div class="rounded-2xl bg-white/[0.03] border border-white/[0.08] p-5 sm:p-6">
            <h3 class="font-semibold text-white mb-6">Traffic Sources</h3>
            <div class="space-y-4">
                {trafficSources.map((source) => (
                    <div>
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm font-medium text-white/80">{source.source}</span>
                            <span class="text-sm text-white/50">{source.visitors.toLocaleString()} ({source.percentage}%)</span>
                        </div>
                        <div class="h-2 bg-white/[0.05] rounded-full overflow-hidden">
                            <div class={`h-full bg-gradient-to-r ${source.color} rounded-full transition-all duration-500`} style={`width: ${source.percentage}%`}></div>
                        </div>
                    </div>
                ))}
            </div>
        </div>
    </div>

    <!-- Top Pages -->
    <div class="rounded-2xl bg-white/[0.03] border border-white/[0.08] p-5 sm:p-6">
        <h3 class="font-semibold text-white mb-6">Top Pages</h3>
        <div class="overflow-x-auto">
            <table class="w-full">
                <thead>
                    <tr class="border-b border-white/[0.08]">
                        <th class="text-left pb-3 text-xs font-medium text-white/40 uppercase">Page</th>
                        <th class="text-right pb-3 text-xs font-medium text-white/40 uppercase">Views</th>
                        <th class="text-right pb-3 text-xs font-medium text-white/40 uppercase hidden sm:table-cell">% of Total</th>
                        <th class="pb-3 text-xs font-medium text-white/40 uppercase w-32 sm:w-48 hidden sm:table-cell">Distribution</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-white/[0.05]">
                    {topPages.map((page) => (
                        <tr class="hover:bg-white/[0.02]">
                            <td class="py-3">
                                <span class="text-sm font-medium text-violet-400 hover:text-violet-300">{page.path}</span>
                            </td>
                            <td class="py-3 text-right text-sm text-white/70">{page.views.toLocaleString()}</td>
                            <td class="py-3 text-right text-sm text-white/50 hidden sm:table-cell">{page.percentage}%</td>
                            <td class="py-3 hidden sm:table-cell">
                                <div class="h-1.5 bg-white/[0.05] rounded-full overflow-hidden">
                                    <div class="h-full bg-gradient-to-r from-violet-500 to-fuchsia-500 rounded-full" style={`width: ${page.percentage}%`}></div>
                                </div>
                            </td>
                        </tr>
                    ))}
                </tbody>
            </table>
        </div>
    </div>
</AdminLayout>
