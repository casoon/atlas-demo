---
import AdminLayout from "@layouts/AdminLayout.astro";

const metrics = [
    { label: "Page Views", value: "124,892", change: "+12.5%", trend: "up" },
    { label: "Unique Visitors", value: "48,234", change: "+8.3%", trend: "up" },
    { label: "Bounce Rate", value: "32.4%", change: "-2.1%", trend: "down" },
    { label: "Avg. Session", value: "4m 32s", change: "+0.8%", trend: "up" },
];

const topPages = [
    { path: "/home", views: 45230, percentage: 36 },
    { path: "/products", views: 28150, percentage: 23 },
    { path: "/about", views: 18420, percentage: 15 },
    { path: "/contact", views: 12890, percentage: 10 },
    { path: "/blog", views: 9870, percentage: 8 },
];

const trafficSources = [
    { source: "Organic Search", value: 42, color: "from-emerald-500 to-cyan-500" },
    { source: "Direct", value: 28, color: "from-violet-500 to-fuchsia-500" },
    { source: "Social Media", value: 18, color: "from-orange-500 to-rose-500" },
    { source: "Referral", value: 12, color: "from-blue-500 to-indigo-500" },
];
---

<AdminLayout title="Analytics" currentPage="analytics">
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6">
        <div>
            <h2 class="text-xl sm:text-2xl font-bold text-white">Analytics Dashboard</h2>
            <p class="text-white/50 text-sm mt-1">Website performance and visitor insights</p>
        </div>
        <div class="cs-glass-nav p-1 inline-flex gap-1">
            <button data-atlas="button" data-ripple="true" class="px-4 py-2 text-sm text-white bg-white/10 rounded-lg">7 Days</button>
            <button data-atlas="button" data-ripple="true" class="px-4 py-2 text-sm text-white/60 hover:text-white hover:bg-white/5 rounded-lg transition-colors">30 Days</button>
            <button data-atlas="button" data-ripple="true" class="px-4 py-2 text-sm text-white/60 hover:text-white hover:bg-white/5 rounded-lg transition-colors">90 Days</button>
        </div>
    </div>

    <div class="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6" data-atlas="grid" data-stagger="75">
        {metrics.map((metric, i) => (
            <div data-atlas="card" data-hover="lift" class:list={[
                "cs-glass-card p-5",
                i === 0 && "border-emerald-500/20",
                i === 1 && "border-blue-500/20",
                i === 2 && "border-violet-500/20",
                i === 3 && "border-pink-500/20"
            ]}>
                <div class="flex items-start justify-between">
                    <div>
                        <p class="text-sm text-white/60">{metric.label}</p>
                        <p class="text-2xl font-bold text-white mt-1">{metric.value}</p>
                    </div>
                    <span class:list={[
                        "px-2 py-1 text-xs font-medium rounded-full",
                        metric.trend === "up" ? "bg-emerald-500/20 text-emerald-400" : "bg-rose-500/20 text-rose-400"
                    ]}>
                        {metric.change}
                    </span>
                </div>
            </div>
        ))}
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
        <div class="lg:col-span-2 cs-glass-card p-6" data-atlas="card" data-hover="none">
            <div class="flex items-center justify-between mb-6">
                <h3 class="font-semibold text-white">Visitor Trend</h3>
                <div class="flex items-center gap-4 text-sm">
                    <span class="flex items-center gap-2">
                        <span class="w-3 h-3 rounded-full bg-gradient-to-r from-violet-500 to-fuchsia-500"></span>
                        <span class="text-white/50">Visitors</span>
                    </span>
                    <span class="flex items-center gap-2">
                        <span class="w-3 h-3 rounded-full bg-gradient-to-r from-emerald-400 to-cyan-400"></span>
                        <span class="text-white/50">Page Views</span>
                    </span>
                </div>
            </div>
            <div class="h-64 flex items-end justify-around gap-2">
                {[35, 55, 40, 70, 50, 85, 65, 75, 60, 90, 70, 80].map((h) => (
                    <div class="flex-1 flex flex-col items-center gap-1">
                        <div class="w-full flex flex-col gap-1">
                            <div class="w-full rounded-t bg-gradient-to-t from-violet-500/80 to-fuchsia-500/80 transition-all hover:from-violet-400 hover:to-fuchsia-400" style={`height: ${h * 2}px`}></div>
                            <div class="w-full rounded-t bg-gradient-to-t from-emerald-400/60 to-cyan-400/60" style={`height: ${h * 1.2}px`}></div>
                        </div>
                    </div>
                ))}
            </div>
            <div class="flex justify-around mt-2">
                {['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'].map(m => (
                    <span class="text-[10px] text-white/30">{m}</span>
                ))}
            </div>
        </div>

        <div class="cs-glass-card p-6" data-atlas="card" data-hover="none">
            <h3 class="font-semibold text-white mb-6">Traffic Sources</h3>
            <div class="space-y-4">
                {trafficSources.map((source) => (
                    <div>
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm text-white/70">{source.source}</span>
                            <span class="text-sm font-medium text-white">{source.value}%</span>
                        </div>
                        <div class="h-2 bg-white/5 rounded-full overflow-hidden">
                            <div class={`h-full bg-gradient-to-r ${source.color} rounded-full transition-all duration-500`} style={`width: ${source.value}%`}></div>
                        </div>
                    </div>
                ))}
            </div>
            <div class="mt-6 flex justify-center">
                <div class="relative w-32 h-32">
                    <svg class="w-full h-full -rotate-90" viewBox="0 0 36 36">
                        <circle cx="18" cy="18" r="15.9" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="3"></circle>
                        <circle cx="18" cy="18" r="15.9" fill="none" stroke="url(#grad1)" stroke-width="3" stroke-dasharray="42 58" stroke-linecap="round"></circle>
                        <circle cx="18" cy="18" r="15.9" fill="none" stroke="url(#grad2)" stroke-width="3" stroke-dasharray="28 72" stroke-dashoffset="-42" stroke-linecap="round"></circle>
                        <circle cx="18" cy="18" r="15.9" fill="none" stroke="url(#grad3)" stroke-width="3" stroke-dasharray="18 82" stroke-dashoffset="-70" stroke-linecap="round"></circle>
                        <defs>
                            <linearGradient id="grad1"><stop stop-color="#10b981"/><stop offset="1" stop-color="#06b6d4"/></linearGradient>
                            <linearGradient id="grad2"><stop stop-color="#8b5cf6"/><stop offset="1" stop-color="#d946ef"/></linearGradient>
                            <linearGradient id="grad3"><stop stop-color="#f97316"/><stop offset="1" stop-color="#f43f5e"/></linearGradient>
                        </defs>
                    </svg>
                    <div class="absolute inset-0 flex items-center justify-center">
                        <div class="text-center">
                            <p class="text-xl font-bold text-white">100%</p>
                            <p class="text-[10px] text-white/40">Total</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="cs-glass-card p-6" data-atlas="card" data-hover="none">
        <div class="flex items-center justify-between mb-6">
            <h3 class="font-semibold text-white">Top Pages</h3>
            <button data-atlas="button" data-ripple="true" class="text-sm text-violet-400 hover:text-violet-300 transition-colors">View All</button>
        </div>
        <div class="space-y-3" data-atlas="grid" data-stagger="75">
            {topPages.map((page, i) => (
                <div data-atlas="card" data-hover="lift" class="bg-white/5 rounded-xl p-4 cursor-pointer group">
                    <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center gap-3">
                            <span class="w-6 h-6 rounded-lg bg-violet-500/20 flex items-center justify-center text-xs font-medium text-violet-300">{i + 1}</span>
                            <span class="text-white group-hover:text-violet-300 transition-colors">{page.path}</span>
                        </div>
                        <span class="text-sm text-white/50">{page.views.toLocaleString()} views</span>
                    </div>
                    <div class="h-1.5 bg-white/5 rounded-full overflow-hidden">
                        <div class="h-full bg-gradient-to-r from-violet-500 to-fuchsia-500 rounded-full" style={`width: ${page.percentage}%`}></div>
                    </div>
                </div>
            ))}
        </div>
    </div>
</AdminLayout>
